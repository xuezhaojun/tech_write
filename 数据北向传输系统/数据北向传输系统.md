# 数据北向传输系统

（本项目为2017年到2019年之间，我在共济科技期间的主要工作内容）



### 数据北向传输系统是什么？

商业机房监控系统，一般可以被划分提供为**三个不同层次**的服务，如下图：

[![6Iek8I.png](https://z3.ax1x.com/2021/03/22/6Iek8I.png)](https://imgtu.com/i/6Iek8I)

由图可见，这三个层次分别为：

* Hardware and sensors: 
  * 该层位于系统最底层
  * 对应只需要采购硬件设备的客户
* Data and monitoring: 
  * 该层位于系统中层
  * 对应需要将监控和告警数据，集成到客户自身的监控系统的情况
* Display and operate: 
  * 该层位于系统最顶层
  * 为客户提供监控数据的展示，查询，告警，操作等功能

数据传输北向系统主要负责，根据客户方的要求，将监控数据和告警数据，集成到客户方系统。



2017到2019年之间，公司业务从传统的数据机房转入大型数据中心方向，很多项目面临着如下问题：

1. 数据量成倍增涨
2. 客户方提高了数据传输和更新速率的要求

所以需要在客户协议开发的基础上，**新增数据传输系统的设计和开发**，该系统主要作用：

* 封装常用API，将公司产品内部数据系统和客户开发业务协议解耦
* 创建数据缓存层，提高对客户系统的响应能力
* 功能模块化，提高系统的可定制化程度，和交付效率



### 性能需求

以腾讯项目为例，客户方需要每分钟进行全量数据采集（即对全部监控点进行轮询），然后我们的内部数据系统，并没有设计可以支撑高并发查询量。因为内部数据系统的数据更新，主要是依靠底层传感器在监控到数据变更的时候，以推数据的方式主动上传至数据系统。

数据北向传输系统为该场景提供了一个缓存层，满足了客户实时查询的需求：

[![6IeP5d.png](https://z3.ax1x.com/2021/03/22/6IeP5d.png)](https://imgtu.com/i/6IeP5d)



### 封装 & 功能模块化

协议开发一般4，5个项目同时进行的场景很常见，为了提高每一个项目的开发速度和交付速度，数据北向传输系统对内部系统经常被调用的接口做了封装，并以grpc服务的方式暴漏出来；

系统还对不同协议中相同的业务做了抽象提炼和模块化，达到可以通过修改配置和编写脚本满足不同客户协议的效果。

[![6IeFPA.png](https://z3.ax1x.com/2021/03/22/6IeFPA.png)](https://imgtu.com/i/6IeFPA)